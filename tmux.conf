set -g prefix C-Space

# testing
set -g mouse off

# copied from https://github.com/tony/tmux-config/blob/master/.tmux.conf
set-option -g status-style bg=colour235,fg=colour136,default # bg=base02, fg=yellow

# easy reload config
bind-key r source-file ~/.tmux.conf \; display-message "~/.tmux.conf reloaded."

# # set window split
# bind-key v split-window -h
# bind-key b split-window

# default window title colors
set-window-option -g window-status-style fg=colour244,bg=default,dim # fg=base0

# active window title colors
set-window-option -g window-status-current-style fg=colour166,bg=default,bright # fg=orange

# pane border
set-option -g pane-border-style fg=colour235 #fg=base02
set-option -g pane-active-border-style fg=colour240 #fg=base01

# message text
set-option -g message-style bg=colour235,fg=colour166 # bg=base02, fg=orange

# pane number display
set-option -g display-panes-active-colour colour33 #blue
set-option -g display-panes-colour colour166 #orange
# clock
set-window-option -g clock-mode-colour green #green

set -g status-interval 1
set -g status-justify centre # center align window list
set -g status-left-length 20
set -g status-right-length 140
set -g status-left '#[fg=green]#H #[fg=black]â€¢ #[fg=green,bright]#(uname -r | cut -c 1-6)#[default]'
set -g status-right '#[fg=green,bg=default,bright]#(tmux-mem-cpu-load) #[fg=red,dim,bg=default]#(uptime | cut -f 4-5 -d " " | cut -f 1 -d ",") #[fg=white,bg=default]%a%l:%M:%S %p#[default] #[fg=blue]%Y-%m-%d'


set-option -g history-limit 5000
set-window-option -g mode-keys vi
bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
bind c new-window -c "#{pane_current_path}"
setw -g mouse on
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe 'xclip -in -selection clipboard'
#bind a send-keys python3 Space -c Space \' 'import pty;pty.spawn("/bin/bash")' \' Enter C-z 'stty size' Enter 'stty raw -echo; fg' Enter '' Enter 'stty rows 60 cols 235' Enter 'export TERM=xterm' Enter
#bind y send-keys python Space -c Space \' 'import pty;pty.spawn("/bin/bash")' \' Enter C-z 'stty size' Enter 'stty raw -echo; fg' Enter '' Enter 'stty rows 60 cols 235' Enter 'export TERM=xterm' Enter
#bind b run-shell "bash ~/get-ip-tmux.sh #{session_id} #{window_id} #{pane_id}"
#bind b new-window "~/get-ip-tmux.sh #{session_id} #{window_id} #{pane_id}"

# tmux IP menu bindings

# for tmux < 3.2, run in a pane.
# when running in a pane, the menu will have to ask you to select the current pane.
#bind b split-window -c "#{pane_current_path}" -h '~/tmux-ip-menu.py'

# for tmux >= 3.2, run in a popup. pass "popup" as command argument to let the script know this is how it's being run.
# in popup mode, the command "tmux list-panes" displays the pane you were on before the popup appeared, so no selecting required

#bind C-e display-popup -E -w 80% -h 80% '~/tmux-scripts/search-fzf-sploit.sh' 
#bind C-g display-popup -E -w 80% -h 80% './tmux-scripts/run-github-exploit-index.sh' 

# ctrl e: find exploits
bind C-e display-popup -E -w 80% -h 80% '~/tmux-scripts/exploit-search-init.sh'

# ctrl f: fuzzy find files
bind C-f split-window -c "#{pane_current_path}" -h bash -c 'echo -n $(fzf) | tmux loadb -'

# ctrl m: manage files
bind C-q split-window -c "#{pane_current_path}" -h '~/tmux-scripts/fff/fff'
bind C-m split-window -c "#{pane_current_path}" -h bash -c 'bat --color=always -pp ~/tmux-scripts/hotkeys.md | less -R'

# ctrl v: edit in vim
bind C-v split-window -c "#{pane_current_path}" bash -c 'nvim $(fzf)'
bind C-x split-window -c "#{pane_current_path}" bash -c 'nvim $(find / -type f 2>/dev/null | fzf)'

bind C-i split-window -c "#{pane_current_path}" bash -c '~/tmux-scripts/kb.sh'

bind-key 'C-h' select-pane -L
bind-key 'C-j' select-pane -D
bind-key 'C-k' select-pane -U
bind-key 'C-l' select-pane -R

#bind C-v split-window -c "#{pane_current_path}"
bind C-g split-window -h -c "#{pane_current_path}"
bind C-s split-window -c "#{pane_current_path}"

bind C-Space display-popup -E -w 80% -h 80% '~/tmux-scripts/menu.sh'

bind C-r split-window -c "#{pane_current_path}" bash -c '~/tmux-scripts/lazygit'
